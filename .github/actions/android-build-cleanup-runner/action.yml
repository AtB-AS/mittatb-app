name: Android Build Runner Cleanup
description: 'Cleans up unnecessary stuff on the Runner VM for Android Build'

runs:
  using: "composite"
  steps:
    - name: Remove DOTNET
      shell: bash
      run: |
        sudo rm -rf /usr/share/dotnet
    - name: Remove HASKELL
      shell: bash
      run: |
        sudo rm -rf /opt/ghc
        sudo rm -rf /usr/local/.ghcup
    - name: Remove CodeQL and PowerShell
      shell: bash
      run: |
        sudo rm -rf /opt/hostedtoolcache/CodeQL
        sudo rm -rf /usr/local/share/powershell
    - name: Remove Docker Images
      shell: bash
      run: |
        docker system prune -a -f
    - name: Remove large packages
      shell: bash
      run: |
        sudo apt-get remove -y '^llvm-.*' --fix-missing || echo "::warning::The command [sudo apt-get remove -y '^llvm-.*' --fix-missing] failed to complete successfully. Proceeding..."
        sudo apt-get remove -y azure-cli google-chrome-stable firefox powershell mono-devel libgl1-mesa-dri --fix-missing || echo "::warning::The command [sudo apt-get remove -y azure-cli google-chrome-stable firefox powershell mono-devel libgl1-mesa-dri --fix-missing] failed to complete successfully. Proceeding..."
        sudo apt-get autoremove -y || echo "::warning::The command [sudo apt-get autoremove -y] failed to complete successfully. Proceeding..."
        sudo apt-get clean || echo "::warning::The command [sudo apt-get clean] failed to complete successfully. Proceeding..."
