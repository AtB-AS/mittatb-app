{"version":3,"sources":["LoadingHandler.ts"],"names":["loadingHandler","token","state","tokenNeedsRenewal","tokenValidityStart","getTime24HoursAgo","err","error","type","message","date","Date","setDate","getDate","getTime"],"mappings":";;;;;;;AAAA;;AAGe,eAAeA,cAAf,GAAsD;AACnE,MAAI;AACF,UAAMC,KAAK,GAAG,MAAM,uBAApB;;AACA,QAAI,CAACA,KAAL,EAAY;AACV,aAAO;AAAEC,QAAAA,KAAK,EAAE;AAAT,OAAP;AACD,KAFD,MAEO;AACL,YAAMC,iBAAiB,GAAGF,KAAK,CAACG,kBAAN,GAA2BC,iBAAiB,EAAtE;AACA,aAAOF,iBAAiB,GACpB;AAAED,QAAAA,KAAK,EAAE;AAAT,OADoB,GAEpB;AAAEA,QAAAA,KAAK,EAAE;AAAT,OAFJ;AAGD;AACF,GAVD,CAUE,OAAOI,GAAP,EAAY;AACZ,WAAO;AACLJ,MAAAA,KAAK,EAAE,SADF;AAELK,MAAAA,KAAK,EAAE;AACLC,QAAAA,IAAI,EAAE,SADD;AAELC,QAAAA,OAAO,EAAE,mCAFJ;AAGLH,QAAAA;AAHK;AAFF,KAAP;AAQD;AACF;;AAED,MAAMD,iBAAiB,GAAG,MAAM;AAC9B,QAAMK,IAAI,GAAG,IAAIC,IAAJ,EAAb;AACAD,EAAAA,IAAI,CAACE,OAAL,CAAaF,IAAI,CAACG,OAAL,KAAiB,CAA9B;AACA,SAAOH,IAAI,CAACI,OAAL,EAAP;AACD,CAJD","sourcesContent":["import { getToken } from '../../native';\nimport type { TokenStatus } from '../types';\n\nexport default async function loadingHandler(): Promise<TokenStatus> {\n  try {\n    const token = await getToken();\n    if (!token) {\n      return { state: 'Initiating' };\n    } else {\n      const tokenNeedsRenewal = token.tokenValidityStart < getTime24HoursAgo();\n      return tokenNeedsRenewal\n        ? { state: 'Renewing' }\n        : { state: 'Validating' };\n    }\n  } catch (err) {\n    return {\n      state: 'Loading',\n      error: {\n        type: 'Unknown',\n        message: 'Error loading native token status',\n        err,\n      },\n    };\n  }\n}\n\nconst getTime24HoursAgo = () => {\n  const date = new Date();\n  date.setDate(date.getDate() - 1);\n  return date.getTime();\n};\n"]}