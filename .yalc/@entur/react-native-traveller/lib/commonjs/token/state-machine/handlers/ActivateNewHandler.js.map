{"version":3,"sources":["ActivateNewHandler.ts"],"names":["activateNewHandler","abtTokensService","s","tokenId","accountId","logger","info","undefined","activateTokenResponse","activateToken","attestationData","state","activatedData"],"mappings":";;;;;;;AACA;;AACA;;AACA;;AAEe,SAASA,kBAAT,CACbC,gBADa,EAEC;AACd,SAAO,yCAAoB,CAAC,aAAD,CAApB,EAAqC,MAAOC,CAAP,IAAa;AACvD,UAAM;AAAEC,MAAAA,OAAF;AAAWC,MAAAA;AAAX,QAAyBF,CAA/B;;AACAG,mBAAOC,IAAP,CAAY,cAAZ,EAA4BC,SAA5B,EAAuC;AAAEJ,MAAAA,OAAF;AAAWC,MAAAA;AAAX,KAAvC;;AAEA,UAAMI,qBAAqB,GAAG,MAAMP,gBAAgB,CAACQ,aAAjB,CAClCN,OADkC,EAElCD,CAAC,CAACQ,eAFgC,CAApC;AAKA,qCAAqBP,OAArB,EAA8BK,qBAAqB,CAACL,OAApD;AAEA,WAAO;AACLC,MAAAA,SAAS,EAAEA,SADN;AAELO,MAAAA,KAAK,EAAE,UAFF;AAGLR,MAAAA,OAAO,EAAED,CAAC,CAACC,OAHN;AAILS,MAAAA,aAAa,EAAEJ;AAJV,KAAP;AAMD,GAjBM,CAAP;AAkBD","sourcesContent":["import type { AbtTokensService } from '../../abt-tokens-service';\nimport { verifyCorrectTokenId } from '../utils';\nimport { StateHandler, stateHandlerFactory } from '../HandlerFactory';\nimport { logger } from '../../../logger';\n\nexport default function activateNewHandler(\n  abtTokensService: AbtTokensService\n): StateHandler {\n  return stateHandlerFactory(['ActivateNew'], async (s) => {\n    const { tokenId, accountId } = s;\n    logger.info('activate_new', undefined, { tokenId, accountId });\n\n    const activateTokenResponse = await abtTokensService.activateToken(\n      tokenId,\n      s.attestationData\n    );\n\n    verifyCorrectTokenId(tokenId, activateTokenResponse.tokenId);\n\n    return {\n      accountId: accountId,\n      state: 'AddToken',\n      tokenId: s.tokenId,\n      activatedData: activateTokenResponse,\n    };\n  });\n}\n"]}