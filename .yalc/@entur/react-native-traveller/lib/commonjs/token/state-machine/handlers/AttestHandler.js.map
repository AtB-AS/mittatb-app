{"version":3,"sources":["AttestHandler.ts"],"names":["attestHandler","_","s","tokenId","nonce","attestationEncryptionPublicKey","initiatedData","activateTokenRequestBody","state","attestationData"],"mappings":";;;;;;;AAAA;;AAGA;;AAEe,SAASA,aAAT,CAAuBC,CAAvB,EAA0D;AACvE,SAAO,yCAAoB,CAAC,WAAD,EAAc,eAAd,CAApB,EAAoD,MAAOC,CAAP,IAAa;AACtE,UAAM;AAAEC,MAAAA,OAAF;AAAWC,MAAAA,KAAX;AAAkBC,MAAAA;AAAlB,QAAqDH,CAAC,CAACI,aAA7D;AAEA,UAAMC,wBAAwB,GAAG,MAAM,yCACrCJ,OADqC,EAErCC,KAFqC,EAGrCC,8BAHqC,CAAvC;AAMA,WAAO;AACLG,MAAAA,KAAK,EAAEN,CAAC,CAACM,KAAF,KAAY,WAAZ,GAA0B,aAA1B,GAA0C,iBAD5C;AAELL,MAAAA,OAAO,EAAEA,OAFJ;AAGLM,MAAAA,eAAe,EAAEF;AAHZ,KAAP;AAKD,GAdM,CAAP;AAeD","sourcesContent":["import { getActivateTokenRequestBody } from '../../attest';\nimport type { AbtTokensService } from '../../abt-tokens-service';\nimport type { StateHandler } from '../HandlerFactory';\nimport { stateHandlerFactory } from '../HandlerFactory';\n\nexport default function attestHandler(_: AbtTokensService): StateHandler {\n  return stateHandlerFactory(['AttestNew', 'AttestRenewal'], async (s) => {\n    const { tokenId, nonce, attestationEncryptionPublicKey } = s.initiatedData;\n\n    const activateTokenRequestBody = await getActivateTokenRequestBody(\n      tokenId,\n      nonce,\n      attestationEncryptionPublicKey\n    );\n\n    return {\n      state: s.state === 'AttestNew' ? 'ActivateNew' : 'ActivateRenewal',\n      tokenId: tokenId,\n      attestationData: activateTokenRequestBody,\n    };\n  });\n}\n"]}