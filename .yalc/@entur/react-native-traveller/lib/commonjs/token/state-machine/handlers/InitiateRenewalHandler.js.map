{"version":3,"sources":["InitiateRenewalHandler.ts"],"names":["initiateRenewalHandler","abtTokensService","s","signedToken","accountId","tokenId","PayloadAction","addRemoveToken","renewTokenResponse","renewToken","oldTokenId","state","initiatedData"],"mappings":";;;;;;;AAAA;;AAEA;;AAEA;;AAEe,SAASA,sBAAT,CACbC,gBADa,EAEC;AACd,SAAO,yCAAoB,CAAC,iBAAD,CAApB,EAAyC,MAAOC,CAAP,IAAa;AAC3D,UAAMC,WAAW,GAAG,MAAM,4BAAeD,CAAC,CAACE,SAAjB,EAA4BF,CAAC,CAACG,OAA9B,EAAuC,IAAvC,EAA6C,CACrEC,qBAAcC,cADuD,CAA7C,CAA1B;AAGA,UAAMC,kBAAkB,GAAG,MAAMP,gBAAgB,CAACQ,UAAjB,CAA4BN,WAA5B,CAAjC;AACA,WAAO;AACLC,MAAAA,SAAS,EAAEF,CAAC,CAACE,SADR;AAELM,MAAAA,UAAU,EAAER,CAAC,CAACG,OAFT;AAGLM,MAAAA,KAAK,EAAE,eAHF;AAILC,MAAAA,aAAa,EAAEJ;AAJV,KAAP;AAMD,GAXM,CAAP;AAYD","sourcesContent":["import { getSecureToken } from '../../../native';\nimport type { AbtTokensService } from '../../abt-tokens-service';\nimport { PayloadAction } from '../../../native/types';\nimport type { StateHandler } from '../HandlerFactory';\nimport { stateHandlerFactory } from '../HandlerFactory';\n\nexport default function initiateRenewalHandler(\n  abtTokensService: AbtTokensService\n): StateHandler {\n  return stateHandlerFactory(['InitiateRenewal'], async (s) => {\n    const signedToken = await getSecureToken(s.accountId, s.tokenId, true, [\n      PayloadAction.addRemoveToken,\n    ]);\n    const renewTokenResponse = await abtTokensService.renewToken(signedToken);\n    return {\n      accountId: s.accountId,\n      oldTokenId: s.tokenId,\n      state: 'AttestRenewal',\n      initiatedData: renewTokenResponse,\n    };\n  });\n}\n"]}