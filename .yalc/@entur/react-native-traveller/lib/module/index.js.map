{"version":3,"sources":["index.ts"],"names":["getConfigFromInitialConfig","getToken","deleteToken","getSecureToken","createInitToken","createRenewToken","isTokenValid","createFetcher","PayloadAction","RequestError","onStartup","fetcher","hosts","token","createClient","initialConfig","config","initToken","generateQrCode","ticketInspection"],"mappings":"AAAA,SACEA,0BADF,QAKO,UALP;AAMA,SAASC,QAAT,EAAmBC,WAAnB,EAAgCC,cAAhC,QAAsD,UAAtD;AACA,SAASC,eAAT,EAA0BC,gBAA1B,EAA4CC,YAA5C,QAAgE,SAAhE;AACA,SAASC,aAAT,QAA8B,WAA9B;AACA,SAASC,aAAT,QAA8B,gBAA9B;AAGA,SAASF,YAAT,QAA6B,SAA7B;AACA,SAASG,YAAT,QAA6B,WAA7B;;AAGA,eAAeC,SAAf,CAAyBC,OAAzB,EAAyCC,KAAzC,EAAuD;AACrD,QAAMC,KAAK,GAAG,MAAMZ,QAAQ,EAA5B;;AAEA,MAAIY,KAAK,IAAI,CAACP,YAAY,CAACO,KAAD,CAA1B,EAAmC;AACjCR,IAAAA,gBAAgB,CAACM,OAAD,EAAUC,KAAV,CAAhB,CAAiCC,KAAjC;AACD;AACF;;AAED,eAAe,SAASC,YAAT,CAAsBC,aAAtB,EAAqD;AAClE,QAAMC,MAAM,GAAGhB,0BAA0B,CAACe,aAAD,CAAzC;AACA,QAAMJ,OAAO,GAAGJ,aAAa,CAACS,MAAD,CAA7B;AAEAN,EAAAA,SAAS,CAACC,OAAD,EAAUK,MAAM,CAACJ,KAAjB,CAAT;AAEA,SAAO;AACLK,IAAAA,SAAS,EAAEb,eAAe,CAACO,OAAD,EAAUK,MAAM,CAACJ,KAAjB,CADrB;AAELX,IAAAA,QAFK;AAGLC,IAAAA,WAHK;AAILgB,IAAAA,cAAc,EAAE,MAAMf,cAAc,CAAC,CAACK,aAAa,CAACW,gBAAf,CAAD;AAJ/B,GAAP;AAMD","sourcesContent":["import {\n  getConfigFromInitialConfig,\n  Fetch,\n  InitialConfig,\n  Hosts,\n} from './config';\nimport { getToken, deleteToken, getSecureToken } from './native';\nimport { createInitToken, createRenewToken, isTokenValid } from './token';\nimport { createFetcher } from './fetcher';\nimport { PayloadAction } from './native/types';\n\nexport type { Token } from './native/types';\nexport { isTokenValid } from './token';\nexport { RequestError } from './fetcher';\nexport type { Fetch, ApiResponse, ApiRequest } from './config';\n\nasync function onStartup(fetcher: Fetch, hosts: Hosts) {\n  const token = await getToken();\n\n  if (token && !isTokenValid(token)) {\n    createRenewToken(fetcher, hosts)(token);\n  }\n}\n\nexport default function createClient(initialConfig?: InitialConfig) {\n  const config = getConfigFromInitialConfig(initialConfig);\n  const fetcher = createFetcher(config);\n\n  onStartup(fetcher, config.hosts);\n\n  return {\n    initToken: createInitToken(fetcher, config.hosts),\n    getToken,\n    deleteToken,\n    generateQrCode: () => getSecureToken([PayloadAction.ticketInspection]),\n  };\n}\n"]}