{"version":3,"sources":["ValidatingHandler.ts"],"names":["getToken","validatingHandler","abtTokensService","token","state","tokens","listTokens","tokenFound","some","t","id","tokenId","err","error","type","message"],"mappings":"AAAA,SAASA,QAAT,QAAyB,cAAzB;AAIA,eAAe,eAAeC,iBAAf,CACbC,gBADa,EAES;AACtB,MAAI;AACF,UAAMC,KAAK,GAAG,MAAMH,QAAQ,EAA5B;;AACA,QAAI,CAACG,KAAL,EAAY;AACV,aAAO;AAAEC,QAAAA,KAAK,EAAE;AAAT,OAAP;AACD;;AAED,UAAMC,MAA0B,GAAG,MAAMH,gBAAgB,CAACI,UAAjB,EAAzC;AACA,UAAMC,UAAU,GAAGF,MAAM,CAACG,IAAP,CAAaC,CAAD,IAAOA,CAAC,CAACC,EAAF,KAASP,KAAK,CAACQ,OAAlC,CAAnB;AACA,WAAO;AAAEP,MAAAA,KAAK,EAAEG,UAAU,GAAG,OAAH,GAAa;AAAhC,KAAP;AACD,GATD,CASE,OAAOK,GAAP,EAAY;AACZ,WAAO;AACLR,MAAAA,KAAK,EAAE,YADF;AAELS,MAAAA,KAAK,EAAE;AACLC,QAAAA,IAAI,EAAE,SADD;AAELC,QAAAA,OAAO,EAAE,uCAFJ;AAGLH,QAAAA;AAHK;AAFF,KAAP;AAQD;AACF","sourcesContent":["import { getToken } from '../../native';\nimport type { AbtTokensService } from '../abt-tokens-service';\nimport type { ListTokensResponse, TokenStatus } from '../types';\n\nexport default async function validatingHandler(\n  abtTokensService: AbtTokensService\n): Promise<TokenStatus> {\n  try {\n    const token = await getToken();\n    if (!token) {\n      return { state: 'Initiating' };\n    }\n\n    const tokens: ListTokensResponse = await abtTokensService.listTokens();\n    const tokenFound = tokens.some((t) => t.id === token.tokenId);\n    return { state: tokenFound ? 'Valid' : 'Initiating' };\n  } catch (err) {\n    return {\n      state: 'Validating',\n      error: {\n        type: 'Unknown',\n        message: 'Error validating token backend status',\n        err,\n      },\n    };\n  }\n}\n"]}