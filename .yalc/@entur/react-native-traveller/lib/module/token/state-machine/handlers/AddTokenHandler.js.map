{"version":3,"sources":["AddTokenHandler.ts"],"names":["logger","addToken","stateHandlerFactory","addTokenHandler","s","activatedData","certificate","tokenId","tokenValidityEnd","tokenValidityStart","accountId","state","info","undefined"],"mappings":"AAAA,SAASA,MAAT,QAAuB,iBAAvB;AACA,SAASC,QAAT,QAAyB,iBAAzB;AACA,SAAuBC,mBAAvB,QAAkD,mBAAlD;AAEA,eAAe,SAASC,eAAT,GAAyC;AACtD,SAAOD,mBAAmB,CAAC,CAAC,UAAD,CAAD,EAAe,MAAOE,CAAP,IAAa;AACpD,UAAM;AACJC,MAAAA,aAAa,EAAE;AACbC,QAAAA,WADa;AAEbC,QAAAA,OAFa;AAGbC,QAAAA,gBAHa;AAIbC,QAAAA;AAJa,OADX;AAOJC,MAAAA,SAPI;AAQJC,MAAAA;AARI,QASFP,CATJ;AAWAJ,IAAAA,MAAM,CAACY,IAAP,CAAY,2BAAZ,EAAyCC,SAAzC,EAAoD;AAClDH,MAAAA,SADkD;AAElDH,MAAAA,OAFkD;AAGlDI,MAAAA;AAHkD,KAApD;AAMA,UAAMV,QAAQ,CACZS,SADY,EAEZH,OAFY,EAGZD,WAHY,EAIZG,kBAJY,EAKZD,gBALY,CAAd;AAOA,WAAO;AACLE,MAAAA,SADK;AAELC,MAAAA,KAAK,EAAE,wBAFF;AAGLJ,MAAAA;AAHK,KAAP;AAKD,GA9ByB,CAA1B;AA+BD","sourcesContent":["import { logger } from '../../../logger';\nimport { addToken } from '../../../native';\nimport { StateHandler, stateHandlerFactory } from '../HandlerFactory';\n\nexport default function addTokenHandler(): StateHandler {\n  return stateHandlerFactory(['AddToken'], async (s) => {\n    const {\n      activatedData: {\n        certificate,\n        tokenId,\n        tokenValidityEnd,\n        tokenValidityStart,\n      },\n      accountId,\n      state,\n    } = s;\n\n    logger.info('mobiletoken_status_change', undefined, {\n      accountId,\n      tokenId,\n      state,\n    });\n\n    await addToken(\n      accountId,\n      tokenId,\n      certificate,\n      tokenValidityStart,\n      tokenValidityEnd\n    );\n    return {\n      accountId,\n      state: 'VerifyInspectionAction',\n      tokenId,\n    };\n  });\n}\n"]}